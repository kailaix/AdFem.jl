<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Steady-state Navier-Stokes equations · PoreFlow</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">PoreFlow</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">PoreFlow.jl Documentation</a></li><li><a class="tocitem" href="../gallery/">PDE Galleries</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../coupled/">Coupled Geomechanics and Single Phase Flow</a></li><li><a class="tocitem" href="../staticelasticity/">Static Linear Elasticity</a></li><li><a class="tocitem" href="../plasticity/">Plasticity</a></li><li><a class="tocitem" href="../viscoelasticity/">Viscoelasticity</a></li><li><a class="tocitem" href="../viscoelasticity_earth/">Modeling Viscoelasticity of the Earth</a></li><li><a class="tocitem" href="../earthquake/">Earthquake Simulation with Rate-and-State Friction</a></li><li><a class="tocitem" href="../heatequation/">Heat Equation</a></li><li><a class="tocitem" href="../elastodynamics/">Elastodynamics</a></li><li><a class="tocitem" href="../twophaseflow/">Coupled Geomechanics and Multiphase Flow</a></li><li><a class="tocitem" href="../NavierStokes2/">Navier-Stokes equations</a></li><li class="is-active"><a class="tocitem" href>Steady-state Navier-Stokes equations</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Steady-state-Navier-Stokes-equations-for-incompressible-flow"><span>Steady-state Navier-Stokes equations for incompressible flow</span></a></li><li><a class="tocitem" href="#The-Newton&#39;s-method"><span>The Newton&#39;s method</span></a></li><li class="toplevel"><a class="tocitem" href="#Numerical-experiments"><span>Numerical experiments</span></a></li></ul></li><li><a class="tocitem" href="../CHTCoupled/">Conjugate heat transfer coupled solver for incompressible fluid</a></li></ul></li><li><span class="tocitem">Inverse Modeling</span><ul><li><a class="tocitem" href="../inverse/">Inverse Modeling for Poroelasticity Models</a></li><li><a class="tocitem" href="../inv_viscoelasticity/">Inverse Modeling for Space Varying Viscoelasticity</a></li><li><a class="tocitem" href="../coupled_viscoelasticity/">Coupled Viscoelasticity and Single Phase Flow</a></li><li><a class="tocitem" href="../inv_twophaseflow/">Coupled Geomechanics and Multiphase Flow</a></li><li><a class="tocitem" href="../inv_viscoelasticity_nonparametric/">Inverse Modeling for Nonparametric Viscoelasticity</a></li><li><a class="tocitem" href="../inv_viscoelasticity_earth/">Viscoelasticity Model for the Earth</a></li></ul></li><li><span class="tocitem">Unstructured Mesh</span><ul><li><a class="tocitem" href="../mfem_tutorial/">Unstructured Meshes in PoreFlow</a></li><li><a class="tocitem" href="../mfem_mesh/">Construct Unstructured Meshes for PoreFlow</a></li><li><a class="tocitem" href="../dev_unstructured/">Adding Custom Operators for Unstructured Meshes</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Steady-state Navier-Stokes equations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Steady-state Navier-Stokes equations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kailaix/PoreFlow.jl/blob/master/docs/src/SteadyStateNavierStokes.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Steady-state-Navier-Stokes-equations"><a class="docs-heading-anchor" href="#Steady-state-Navier-Stokes-equations">Steady-state Navier-Stokes equations</a><a id="Steady-state-Navier-Stokes-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Steady-state-Navier-Stokes-equations" title="Permalink"></a></h1><p>The Navier-Stokes equations describe the motion of viscous flow formed by a fluid material. Assume the material has density <span>$\rho$</span>, dynamic viscosity <span>$\mu$</span>, velocity <span>$\bf u$</span>, pressure <span>$p$</span>, and body accelerations <span>$\bf g$</span>, the Navier-Stokes equations include the the continuity equation, which describes the conservation of mass:</p><div>\[\frac{\partial \rho}{\partial t} + \sum_i \frac{\partial \rho u_i}{\partial x_i} = 0,\]</div><p>and the momentum equation, which describes the conservation of momentum in each spatial direction:</p><div>\[\frac{\partial \rho u_i}{\partial t} + \sum_j \frac{\partial \rho u_i u_j}{\partial x_j} = \sum_j \frac{\partial \tau_{ij}}{\partial x_j} - \frac{\partial p }{\partial x_i}+\rho g_i, \quad \forall i,\]</div><p>where the stress tensor <span>$\tau_{ij}$</span> is defined as <span>$\tau_{ij} = \mu \left(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i} \right) - \frac{2}{3} \mu \delta_{ij} \frac{\partial u_j}{\partial x_j}.$</span></p><h1 id="Steady-state-Navier-Stokes-equations-for-incompressible-flow"><a class="docs-heading-anchor" href="#Steady-state-Navier-Stokes-equations-for-incompressible-flow">Steady-state Navier-Stokes equations for incompressible flow</a><a id="Steady-state-Navier-Stokes-equations-for-incompressible-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Steady-state-Navier-Stokes-equations-for-incompressible-flow" title="Permalink"></a></h1><p>We assume the fluid material is incompressible with constant density <span>$\rho$</span>, and we denote its the kinematic viscosity as <span>$\nu=\mu / \rho$</span>. We assume that the system has reached a steady state. Then, the steady-state incompressible Navier-Stokes equations in two spatial dimensions are given by</p><div>\[\frac{\partial u}{\partial x}+\frac{\partial v}{\partial y}=0 \tag{1}\]</div><div>\[u \frac{\partial u}{\partial x}+v \frac{\partial u}{\partial y}=-\frac{1}{\rho} \frac{\partial p}{\partial x}+\nu\left(\frac{\partial^{2} u}{\partial x^{2}}+\frac{\partial^{2} u}{\partial y^{2}}\right)+f \tag{2}\]</div><div>\[u \frac{\partial v}{\partial x}+v \frac{\partial v}{\partial y}=-\frac{1}{\rho} \frac{\partial p}{\partial y}+\nu\left(\frac{\partial^{2} v}{\partial x^{2}}+\frac{\partial^{2} v}{\partial y^{2}}\right)+g \tag{3}\]</div><p>where (1) is the continuity equation and (2)-(3) are the momentum equations.</p><h2 id="The-Newton&#39;s-method"><a class="docs-heading-anchor" href="#The-Newton&#39;s-method">The Newton&#39;s method</a><a id="The-Newton&#39;s-method-1"></a><a class="docs-heading-anchor-permalink" href="#The-Newton&#39;s-method" title="Permalink"></a></h2><p>Let <span>$\delta u&#39;$</span> denote the finite element basis for <span>$u$</span>, and <span>$\delta v&#39;$</span> denote the finite element basis for <span>$v$</span>. To derive the weak form, we multiply both sides of (2)-(3) by <span>$\delta u&#39;$</span> and <span>$\delta v&#39;$</span>, respectively.</p><div>\[\left(u \frac{\partial u}{\partial x}, \delta u&#39;\right)+ \left(v \frac{\partial u}{\partial y} , \delta u&#39;\right) =  -\frac{1}{\rho} \left(\frac{\partial p}{\partial x}, \delta u&#39;\right)+\nu\left(\frac{\partial^{2} u}{\partial x^{2}}+\frac{\partial^{2} u}{\partial y^{2}}, \ \delta u&#39;\right)+\left(f, \delta u&#39;\right)\]</div><div>\[\left(u \frac{\partial v}{\partial x}, \delta v&#39;\right) + \left(v \frac{\partial v}{\partial y}, \delta v&#39;\right) = -\frac{1}{\rho}\left( \frac{\partial p}{\partial y}, \delta v&#39;\right) +\nu\left(\frac{\partial^{2} v}{\partial x^{2}}+\frac{\partial^{2} v}{\partial y^{2}} ,\ \delta v&#39;\right)+ \left( g, \delta v&#39;\right)\]</div><p>Then we have the following weak form</p><div>\[\left(u \frac{\partial u}{\partial x}, \delta u&#39;\right)+ \left(v \frac{\partial u}{\partial y} , \delta u&#39;\right) =  \frac{1}{\rho} \left(p, \ \frac{\partial \delta u&#39;}{\partial x}\right)-\nu\left(\nabla u, \nabla \delta u&#39;\right)+\left(f, \delta u&#39;\right) \tag{4}\]</div><div>\[\left(u \frac{\partial v}{\partial x}, \delta v&#39;\right) + \left(v \frac{\partial v}{\partial y}, \delta v&#39;\right) = \frac{1}{\rho}\left(p, \frac{\partial \delta v&#39;}{\partial y}\right) -\nu\left(\nabla v, \nabla\delta v&#39;\right)+ \left( g, \delta v&#39;\right) \tag{5}\]</div><p>Additionally, we multiply both sides of (1) by <span>$\delta p&#39;$</span>, then we have</p><div>\[\left(\frac{\partial u}{\partial x}, \delta p&#39;\right) + \left(\frac{\partial v}{\partial y}, \delta p&#39; \right) = 0 \tag{6}\]</div><p>The weak form (4),(5), and (6) are nonlinear in <span>$u$</span> and <span>$v$</span>. We use the Newton&#39;s method to solve coupled system  iteratively.</p><p>To this end, we define the residual functions</p><div>\[F(u,v) = \left(u \frac{\partial u}{\partial x}, \delta u&#39;\right)+ \left(v \frac{\partial u}{\partial y} , \delta u&#39;\right) -  \frac{1}{\rho} \left(p, \ \frac{\partial \delta u&#39;}{\partial x}\right)+ \nu\left(\nabla u, \nabla \delta u&#39;\right)-\left(f, \delta u&#39;\right)\]</div><div>\[G(u,v) = \left(u \frac{\partial v}{\partial x}, \delta v&#39;\right) + \left(v \frac{\partial v}{\partial y}, \delta v&#39;\right) -\frac{1}{\rho}\left(p, \frac{\partial \delta v&#39;}{\partial y}\right) +\nu\left(\nabla v, \nabla\delta v&#39;\right)- \left( g, \delta v&#39;\right)\]</div><div>\[H(u, v) = \left(\frac{\partial u}{\partial x}, \delta p&#39;\right) + \left(\frac{\partial v}{\partial y}, \delta p&#39; \right)\]</div><p>we have the following equation for one iteration of the Newton&#39;s method</p><div>\[\begin{bmatrix}\nabla_u F(u,v)  &amp; \nabla_v F(u,v) &amp; \nabla_p F(u, v)  \\ \nabla_u G(u,v)  &amp; \nabla_v G(u,v) &amp; \nabla_p G(u, v) \\ \nabla_u H(u, v) &amp; \nabla_v H(u,v) &amp; 0\end{bmatrix} \begin{bmatrix}\Delta u\\ \Delta v \\ \Delta p\end{bmatrix} = - \begin{bmatrix}F(u,v) \\ G(u,v)\\H(u,v) \end{bmatrix} \tag{4}\]</div><div>\[\begin{bmatrix} u_{new}\\ v_{new} \\ p_{new} \end{bmatrix} = \begin{bmatrix} u\\ v \\ p\end{bmatrix} + \begin{bmatrix}\Delta u\\ \Delta v \\\Delta p \end{bmatrix}\]</div><p>We use Taylor&#39;s expansion to linearize <span>$F(u+\Delta u, v+\Delta v), G(u+\Delta u, v+\Delta v)$</span> and obtain</p><div>\[F(u+\Delta u, v+\Delta v) = F(u,v) + \nabla_u F(u,v)\Delta u   + \nabla_v F(u,v) \Delta v\]</div><div>\[G(u+\Delta u, v+\Delta v) = G(u,v) + \nabla_u G(u,v) \Delta u + \nabla_v G(u,v)\Delta v\]</div><p>Thus, we have</p><div>\[\nabla_u F(u,v)\Delta u = \left(\Delta u \frac{\partial u}{\partial x}, \delta u&#39;\right) +\left(u \frac{\partial \Delta u }{\partial x}, \delta u&#39;\right)+ \left(v \frac{\partial \Delta u }{\partial y}, \delta u&#39;\right) + (\nu\nabla (\Delta u), \nabla \delta u&#39;)\]</div><div>\[\nabla_v F(u,v)\Delta v = \left(\Delta v \frac{\partial u}{\partial y}, \delta u&#39;\right)\]</div><div>\[\nabla_u G(u,v)\Delta u = \left(\Delta u \frac{\partial v}{\partial x}, \delta v&#39;\right)\]</div><div>\[\nabla_v G(u,v)\Delta v = \left(\Delta v \frac{\partial v}{\partial y}, \delta v&#39;\right) +\left(v \frac{\partial \Delta v }{\partial y}, \delta v&#39;\right)+ \left(u \frac{\partial \Delta v }{\partial x}, \delta v&#39;\right) +ν (\nabla (\Delta v), \nabla \delta v&#39;)\]</div><h1 id="Numerical-experiments"><a class="docs-heading-anchor" href="#Numerical-experiments">Numerical experiments</a><a id="Numerical-experiments-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-experiments" title="Permalink"></a></h1><p>Results of numerical experiments are summarized in the table below. In each case, we assume that the steady-state velocity field is measured at a sample of locations, represented by a sample of grid points in the finite element method. We solve the optimization problem to minimize the difference between the measured velocity and the computed velocity based on the current model parameters. In order to model the uncertainty in the measured data, we include a noise level when we transform the solution to the forwrad problem into measured data: each data will be multiplied by a random scalar which is uniform on (1-noise<em>level, 1+noise</em>level)</p><table><tr><th style="text-align: center">grid size</th><th style="text-align: center">sample size</th><th style="text-align: center">noise level</th><th style="text-align: center">number of iterations</th><th style="text-align: center">exact viscosity</th><th style="text-align: center">predicted viscosity</th></tr><tr><td style="text-align: center">20 by 20</td><td style="text-align: center">20</td><td style="text-align: center">0</td><td style="text-align: center">28</td><td style="text-align: center">0.01</td><td style="text-align: center">0.010000000000000004</td></tr><tr><td style="text-align: center">20 by 20</td><td style="text-align: center">20</td><td style="text-align: center">0.01</td><td style="text-align: center">26</td><td style="text-align: center">0.01</td><td style="text-align: center">0.010025030255978819</td></tr><tr><td style="text-align: center">20 by 20</td><td style="text-align: center">20</td><td style="text-align: center">0.05</td><td style="text-align: center">27</td><td style="text-align: center">0.01</td><td style="text-align: center">0.009872678483953757</td></tr><tr><td style="text-align: center">20 by 20</td><td style="text-align: center">20</td><td style="text-align: center">0.10</td><td style="text-align: center">28</td><td style="text-align: center">0.01</td><td style="text-align: center">0.009981956568710024</td></tr><tr><td style="text-align: center">20 by 20</td><td style="text-align: center">20</td><td style="text-align: center">0.20</td><td style="text-align: center">28</td><td style="text-align: center">0.01</td><td style="text-align: center">0.008823737264381126</td></tr><tr><td style="text-align: center">20 by 20</td><td style="text-align: center">20</td><td style="text-align: center">0.20</td><td style="text-align: center">29</td><td style="text-align: center">0.01</td><td style="text-align: center">0.010599176390172771</td></tr><tr><td style="text-align: center">20 by 20</td><td style="text-align: center">20</td><td style="text-align: center">0.20</td><td style="text-align: center">50</td><td style="text-align: center">0.01</td><td style="text-align: center">0.009202237809712532</td></tr></table></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../NavierStokes2/">« Navier-Stokes equations</a><a class="docs-footer-nextpage" href="../CHTCoupled/">Conjugate heat transfer coupled solver for incompressible fluid »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 16 September 2020 05:50">Wednesday 16 September 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
