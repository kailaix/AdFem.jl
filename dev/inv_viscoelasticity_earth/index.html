<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Viscoelasticity Model for the Earth · PoreFlow</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">PoreFlow</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">PoreFlow.jl Documentation</a></li><li><a class="tocitem" href="../gallery/">PDE Galleries</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../coupled/">Coupled Geomechanics and Single Phase Flow</a></li><li><a class="tocitem" href="../staticelasticity/">Static Linear Elasticity</a></li><li><a class="tocitem" href="../plasticity/">Plasticity</a></li><li><a class="tocitem" href="../viscoelasticity/">Viscoelasticity</a></li><li><a class="tocitem" href="../viscoelasticity_earth/">Modeling Viscoelasticity of the Earth</a></li><li><a class="tocitem" href="../earthquake/">Earthquake Simulation with Rate-and-State Friction</a></li><li><a class="tocitem" href="../heatequation/">Heat Equation</a></li><li><a class="tocitem" href="../elastodynamics/">Elastodynamics</a></li><li><a class="tocitem" href="../twophaseflow/">Coupled Geomechanics and Multiphase Flow</a></li><li><a class="tocitem" href="../NavierStokes2/">Navier-Stokes equations</a></li><li><a class="tocitem" href="../SteadyStateNavierStokes/">Steady-state Navier-Stokes equations</a></li><li><a class="tocitem" href="../CHTCoupled/">Conjugate heat transfer coupled solver for incompressible fluid</a></li></ul></li><li><span class="tocitem">Inverse Modeling</span><ul><li><a class="tocitem" href="../inverse/">Inverse Modeling for Poroelasticity Models</a></li><li><a class="tocitem" href="../inv_viscoelasticity/">Inverse Modeling for Space Varying Viscoelasticity</a></li><li><a class="tocitem" href="../coupled_viscoelasticity/">Coupled Viscoelasticity and Single Phase Flow</a></li><li><a class="tocitem" href="../inv_twophaseflow/">Coupled Geomechanics and Multiphase Flow</a></li><li><a class="tocitem" href="../inv_viscoelasticity_nonparametric/">Inverse Modeling for Nonparametric Viscoelasticity</a></li><li class="is-active"><a class="tocitem" href>Viscoelasticity Model for the Earth</a><ul class="internal"><li><a class="tocitem" href="#Strike-slip-Fault"><span>Strike-slip Fault</span></a></li><li><a class="tocitem" href="#Dip-slip-Fault"><span>Dip-slip Fault</span></a></li></ul></li></ul></li><li><span class="tocitem">Unstructured Mesh</span><ul><li><a class="tocitem" href="../mfem_tutorial/">Unstructured Meshes in PoreFlow</a></li><li><a class="tocitem" href="../mfem_mesh/">Construct Unstructured Meshes for PoreFlow</a></li><li><a class="tocitem" href="../dev_unstructured/">Adding Custom Operators for Unstructured Meshes</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Inverse Modeling</a></li><li class="is-active"><a href>Viscoelasticity Model for the Earth</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Viscoelasticity Model for the Earth</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kailaix/PoreFlow.jl/blob/master/docs/src/inv_viscoelasticity_earth.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Viscoelasticity-Model-for-the-Earth"><a class="docs-heading-anchor" href="#Viscoelasticity-Model-for-the-Earth">Viscoelasticity Model for the Earth</a><a id="Viscoelasticity-Model-for-the-Earth-1"></a><a class="docs-heading-anchor-permalink" href="#Viscoelasticity-Model-for-the-Earth" title="Permalink"></a></h1><p>In <a href="https://kailaix.github.io/PoreFlow.jl/dev/viscoelasticity_earth/">previous section</a>, we show how to conduct forward computation of viscoelasticity models for the earth. In this section, we use a gradient-based optimization (L-BFGS-S) approach for calibrating the spatial-varying viscoelasticity parameters for the viscoelasticity model. The major function we use is <a href="@ref"><code>ViscoelasticitySolver</code></a> in <a href="https://github.com/kailaix/NNFEM.jl/">NNFEM</a> in the NNFEM package.  </p><p>In the following examples, we calibrate the viscoelasticity parameters <span>$\eta$</span> from displacement data on the surface. </p><h2 id="Strike-slip-Fault"><a class="docs-heading-anchor" href="#Strike-slip-Fault">Strike-slip Fault</a><a id="Strike-slip-Fault-1"></a><a class="docs-heading-anchor-permalink" href="#Strike-slip-Fault" title="Permalink"></a></h2><p>In this example, we consider a layer model. In each layer, <span>$\eta$</span> is a constant. The left panel in the following graph shows the ground truth, while the inversion result is shown in the right panel. We can see the inverted <span>$\eta$</span> is quite accurate after 2000 iterations.  </p><table><tr><th style="text-align: right">True model</th><th style="text-align: right">Inverted result</th></tr><tr><td style="text-align: right"><img src="../assets/visco-earth/strikeslip-visco-model.png" alt/></td><td style="text-align: right"><img src="../assets/visco-earth/strikeslip-inv_visco.png" alt/></td></tr></table><p>We show the inversion results in each iteration:</p><center>
<img src="../assets/visco-earth/strikeslip-inv_visco.gif" width=60%>
</center><p>Code:  <a href="https://github.com/kailaix/PoreFlow.jl/blob/master/research/earthquake/strikeslip/antiplane_viscosity_inverse.jl">antiplane<em>viscosity</em>inverse.jl</a></p><h2 id="Dip-slip-Fault"><a class="docs-heading-anchor" href="#Dip-slip-Fault">Dip-slip Fault</a><a id="Dip-slip-Fault-1"></a><a class="docs-heading-anchor-permalink" href="#Dip-slip-Fault" title="Permalink"></a></h2><p>In this example, we consider a linear viscosity model with an increasing viscosity effect at a deeper depth. Because of the limited observation data (displacement on the surface), we do not expect to calibrate a spatially-varying <span>$\eta$</span> for each location. Therefore, we reduce the number of optimizable variables b dividing the computational domain into multiple patches. The patch is obtained using K-means algorithm provided by <code>Clustering.jl</code>: </p><center>
<img src="../assets/visco-earth/dipslip-patch.png" width=50%>
</center><p>The true vsicoelasticity parameter distribution is shown in the left panel in the following graph. The right panel shows the inverted result after 200 iterations. We can see that the inverted result is reasonably good. </p><table><tr><th style="text-align: right">True model</th><th style="text-align: right">Inverted result</th></tr><tr><td style="text-align: right"><img src="../assets/visco-earth/dipslip-linear_model.png" alt/></td><td style="text-align: right"><img src="../assets/visco-earth/dipslip-inv_visco.png" alt/></td></tr></table><p>We also show the inversion results in each iteration:</p><center>
<img src="../assets/visco-earth/dipslip-inv_visco.gif" width=80%>
</center><p>Code: <a href="https://github.com/kailaix/PoreFlow.jl/blob/master/research/earthquake/dipslip/dippingfault_viscosity_forward.jl">dippingfault<em>viscosity</em>forward.jl</a>, <a href="https://github.com/kailaix/PoreFlow.jl/blob/master/research/earthquake/dipslip/dippingfault_viscosity_inversion.jl">dippingfault<em>viscosity</em>inversion.jl</a>, <a href="https://github.com/kailaix/PoreFlow.jl/blob/master/research/earthquake/dipslip/load_domain_function.jl">load<em>domain</em>function.jl</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../inv_viscoelasticity_nonparametric/">« Inverse Modeling for Nonparametric Viscoelasticity</a><a class="docs-footer-nextpage" href="../mfem_tutorial/">Unstructured Meshes in PoreFlow »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 17 September 2020 02:44">Thursday 17 September 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
