<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Steady-state Navier-Stokes equations in 3D space · AdFem</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="AdFem logo"/></a><div class="docs-package-name"><span class="docs-autofit">AdFem</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">AdFem.jl Documentation</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../gallery/">PDE Galleries</a></li></ul></li><li><span class="tocitem">Forward Computation</span><ul><li><a class="tocitem" href="../coupled/">Coupled Geomechanics and Single Phase Flow</a></li><li><a class="tocitem" href="../staticelasticity/">Static Linear Elasticity</a></li><li><a class="tocitem" href="../plasticity/">Plasticity</a></li><li><a class="tocitem" href="../viscoelasticity/">Viscoelasticity</a></li><li><a class="tocitem" href="../viscoelasticity_earth/">Modeling Viscoelasticity of the Earth</a></li><li><a class="tocitem" href="../earthquake/">Earthquake Simulation with Rate-and-State Friction</a></li><li><a class="tocitem" href="../heatequation/">Heat Equation</a></li><li><a class="tocitem" href="../elastodynamics/">Elastodynamics</a></li><li><a class="tocitem" href="../twophaseflow/">Coupled Geomechanics and Multiphase Flow</a></li><li><a class="tocitem" href="../NavierStokes2/">Navier-Stokes equations</a></li><li><a class="tocitem" href="../SteadyStateNavierStokes/">Steady-state Navier-Stokes equations</a></li><li class="is-active"><a class="tocitem" href>Steady-state Navier-Stokes equations in 3D space</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Steady-state-Navier-Stokes-equations-for-incompressible-flow"><span>Steady-state Navier-Stokes equations for incompressible flow</span></a></li><li><a class="tocitem" href="#The-Newton&#39;s-method"><span>The Newton&#39;s method</span></a></li></ul></li><li><a class="tocitem" href="../CHTCoupled/">Conjugate heat transfer coupled solver for incompressible fluid</a></li><li><a class="tocitem" href="../fwd_mixed_poisson/">Mixed Finite Element Methods for Poisson&#39;s Equation</a></li><li><a class="tocitem" href="../fwd_linear_elasticity/">Mixed Finite Element Methods for Linear Elasticity</a></li><li><a class="tocitem" href="../fwd_stress_based_viscoelasticity/">Mixed Finite Element Methods for Linear Viscoelasticity</a></li><li><a class="tocitem" href="../pml/">Perfectly Matched Layer</a></li></ul></li><li><span class="tocitem">Inverse Modeling</span><ul><li><a class="tocitem" href="../inverse/">Inverse Modeling for Poroelasticity Models</a></li><li><a class="tocitem" href="../inv_viscoelasticity/">Inverse Modeling for Space Varying Viscoelasticity</a></li><li><a class="tocitem" href="../coupled_viscoelasticity/">Coupled Viscoelasticity and Single Phase Flow</a></li><li><a class="tocitem" href="../inv_twophaseflow/">Coupled Geomechanics and Multiphase Flow</a></li><li><a class="tocitem" href="../inv_viscoelasticity_nonparametric/">Inverse Modeling for Nonparametric Viscoelasticity</a></li><li><a class="tocitem" href="../inv_viscoelasticity_earth/">Viscoelasticity Model for the Earth</a></li></ul></li><li><span class="tocitem">Advanced Topics</span><ul><li><a class="tocitem" href="../mfem_tutorial/">Unstructured Meshes in AdFem</a></li><li><a class="tocitem" href="../mfem_mesh/">Construct Unstructured Meshes for AdFem</a></li><li><a class="tocitem" href="../dev_unstructured/">Adding Custom Operators for Unstructured Meshes</a></li><li><a class="tocitem" href="../BDMElement/">BDM Finite Element</a></li><li><a class="tocitem" href="../mfem3d/">Working with 3D Domains</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Forward Computation</a></li><li class="is-active"><a href>Steady-state Navier-Stokes equations in 3D space</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Steady-state Navier-Stokes equations in 3D space</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kailaix/AdFem.jl/blob/master/docs/src/SteadyStateNavierStokes3D.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Steady-state-Navier-Stokes-equations-in-3D-space"><a class="docs-heading-anchor" href="#Steady-state-Navier-Stokes-equations-in-3D-space">Steady-state Navier-Stokes equations in 3D space</a><a id="Steady-state-Navier-Stokes-equations-in-3D-space-1"></a><a class="docs-heading-anchor-permalink" href="#Steady-state-Navier-Stokes-equations-in-3D-space" title="Permalink"></a></h1><p>The Navier-Stokes equations describe the motion of viscous flow formed by a fluid material. Assume the material has density <span>$\rho$</span>, dynamic viscosity <span>$\mu$</span>, velocity <span>$\bf u$</span>, pressure <span>$p$</span>, and body accelerations <span>$\bf g$</span>, the Navier-Stokes equations include the the continuity equation, which describes the conservation of mass:</p><p class="math-container">\[\frac{\partial \rho}{\partial t} + \sum_i \frac{\partial \rho u_i}{\partial x_i} = 0,\]</p><p>and the momentum equation, which describes the conservation of momentum in each spatial direction:</p><p class="math-container">\[\frac{\partial \rho u_i}{\partial t} + \sum_j \frac{\partial \rho u_i u_j}{\partial x_j} = \sum_j \frac{\partial \tau_{ij}}{\partial x_j} - \frac{\partial p }{\partial x_i}+\rho g_i, \quad \forall i,\]</p><p>where the stress tensor <span>$\tau_{ij}$</span> is defined as <span>$\tau_{ij} = \mu \left(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i} \right) - \frac{2}{3} \mu \delta_{ij} \frac{\partial u_j}{\partial x_j}.$</span></p><h1 id="Steady-state-Navier-Stokes-equations-for-incompressible-flow"><a class="docs-heading-anchor" href="#Steady-state-Navier-Stokes-equations-for-incompressible-flow">Steady-state Navier-Stokes equations for incompressible flow</a><a id="Steady-state-Navier-Stokes-equations-for-incompressible-flow-1"></a><a class="docs-heading-anchor-permalink" href="#Steady-state-Navier-Stokes-equations-for-incompressible-flow" title="Permalink"></a></h1><p>We assume the fluid material is incompressible with constant density <span>$\rho$</span>, and we denote its the kinematic viscosity as <span>$\nu=\mu / \rho$</span>. We assume that the system has reached a steady state. Then, the steady-state incompressible Navier-Stokes equations in three spatial dimensions are given by</p><p class="math-container">\[\frac{\partial u}{\partial x}+\frac{\partial v}{\partial y}+\frac{\partial w}{\partial z}=0 \tag{1}\]</p><p class="math-container">\[u \frac{\partial u}{\partial x}+v \frac{\partial u}{\partial y}+w \frac{\partial u}{\partial z}=-\frac{1}{\rho} \frac{\partial p}{\partial x}+\nu\left(\frac{\partial^{2} u}{\partial x^{2}}+\frac{\partial^{2} u}{\partial y^{2}}+\frac{\partial^{2} u}{\partial z^{2}}\right)+f \tag{2}\]</p><p class="math-container">\[u \frac{\partial v}{\partial x}+v \frac{\partial v}{\partial y}+w \frac{\partial v}{\partial z}=-\frac{1}{\rho} \frac{\partial p}{\partial y}+\nu\left(\frac{\partial^{2} v}{\partial x^{2}}+\frac{\partial^{2} v}{\partial y^{2}}+\frac{\partial^{2} v}{\partial z^{2}}\right)+g \tag{3}\]</p><p class="math-container">\[u \frac{\partial w}{\partial x}+v \frac{\partial w}{\partial y}+w \frac{\partial w}{\partial z}=-\frac{1}{\rho} \frac{\partial p}{\partial z}+\nu\left(\frac{\partial^{2} w}{\partial x^{2}}+\frac{\partial^{2} w}{\partial y^{2}}+\frac{\partial^{2} w}{\partial z^{2}}\right)+h \tag{4}\]</p><p>where (1) is the continuity equation and (2)-(4) are the momentum equations.</p><h2 id="The-Newton&#39;s-method"><a class="docs-heading-anchor" href="#The-Newton&#39;s-method">The Newton&#39;s method</a><a id="The-Newton&#39;s-method-1"></a><a class="docs-heading-anchor-permalink" href="#The-Newton&#39;s-method" title="Permalink"></a></h2><p>Let <span>$\delta u&#39;$</span> denote the finite element basis for <span>$u$</span>, <span>$\delta v&#39;$</span> denote the finite element basis for <span>$v$</span>, and <span>$\delta w&#39;$</span> denote the finite element basis for <span>$w$</span>. To derive the weak form, we multiply both sides of (2)-(4) by <span>$\delta u&#39;$</span>, <span>$\delta v&#39;$</span>, and <span>$\delta w&#39;$</span>, respectively.</p><p class="math-container">\[\left(u \frac{\partial u}{\partial x}, \delta u&#39;\right)+ \left(v \frac{\partial u}{\partial y} , \delta u&#39;\right)+ \left(w \frac{\partial u}{\partial z} , \delta u&#39;\right) =  -\frac{1}{\rho} \left(\frac{\partial p}{\partial x}, \delta u&#39;\right)+\nu\left(\frac{\partial^{2} u}{\partial x^{2}}+\frac{\partial^{2} u}{\partial y^{2}}+\frac{\partial^{2} u}{\partial z^{2}}, \ \delta u&#39;\right)+\left(f, \delta u&#39;\right)\]</p><p class="math-container">\[\left(u \frac{\partial v}{\partial x}, \delta v&#39;\right) + \left(v \frac{\partial v}{\partial y}, \delta v&#39;\right)+ \left(w \frac{\partial v}{\partial z}, \delta v&#39;\right) = -\frac{1}{\rho}\left( \frac{\partial p}{\partial y}, \delta v&#39;\right) +\nu\left(\frac{\partial^{2} v}{\partial x^{2}}+\frac{\partial^{2} v}{\partial y^{2}}+\frac{\partial^{2} v}{\partial z^{2}} ,\ \delta v&#39;\right)+ \left( g, \delta v&#39;\right)\]</p><p class="math-container">\[\left(u \frac{\partial w}{\partial x}, \delta w&#39;\right) + \left(v \frac{\partial w}{\partial y}, \delta w&#39;\right)+ \left(w \frac{\partial w}{\partial z}, \delta w&#39;\right) = -\frac{1}{\rho}\left( \frac{\partial p}{\partial z}, \delta w&#39;\right) +\nu\left(\frac{\partial^{2} w}{\partial x^{2}}+\frac{\partial^{2} w}{\partial y^{2}}+\frac{\partial^{2} w}{\partial z^{2}} ,\ \delta w&#39;\right)+ \left( h, \delta w&#39;\right)\]</p><p>Then we have the following weak form</p><p class="math-container">\[\left(u \frac{\partial u}{\partial x}, \delta u&#39;\right)+ \left(v \frac{\partial u}{\partial y} , \delta u&#39;\right) + \left(w \frac{\partial u}{\partial z} , \delta u&#39;\right) =  \frac{1}{\rho} \left(p, \ \frac{\partial \delta u&#39;}{\partial x}\right)-\nu\left(\nabla u, \nabla \delta u&#39;\right)+\left(f, \delta u&#39;\right) \tag{5}\]</p><p class="math-container">\[\left(u \frac{\partial v}{\partial x}, \delta v&#39;\right) + \left(v \frac{\partial v}{\partial y}, \delta v&#39;\right) + \left(w \frac{\partial v}{\partial z}, \delta v&#39;\right) = \frac{1}{\rho}\left(p, \frac{\partial \delta v&#39;}{\partial y}\right) -\nu\left(\nabla v, \nabla\delta v&#39;\right)+ \left( g, \delta v&#39;\right) \tag{6}\]</p><p class="math-container">\[\left(u \frac{\partial w}{\partial x}, \delta w&#39;\right) + \left(v \frac{\partial w}{\partial y}, \delta w&#39;\right) + \left(w \frac{\partial w}{\partial z}, \delta w&#39;\right) = \frac{1}{\rho}\left(p, \frac{\partial \delta w&#39;}{\partial z}\right) -\nu\left(\nabla v, \nabla\delta w&#39;\right)+ \left( h, \delta w&#39;\right) \tag{7}\]</p><p>Additionally, we multiply both sides of (1) by <span>$\delta p&#39;$</span>, then we have</p><p class="math-container">\[\left(\frac{\partial u}{\partial x}, \delta p&#39;\right) + \left(\frac{\partial v}{\partial y}, \delta p&#39; \right)+ \left(\frac{\partial w}{\partial z}, \delta p&#39; \right) = 0 \tag{8}\]</p><p>The weak form (4),(5), and (6) are nonlinear in <span>$u$</span>, <span>$v$</span> and <span>$w$</span>. We use the Newton&#39;s method to solve coupled system  iteratively.</p><p>To this end, we define the residual functions</p><p class="math-container">\[F(u,v,w) = \left(u \frac{\partial u}{\partial x}, \delta u&#39;\right)+ \left(v \frac{\partial u}{\partial y} , \delta u&#39;\right) + \left(w \frac{\partial u}{\partial z} , \delta u&#39;\right) -  \frac{1}{\rho} \left(p, \ \frac{\partial \delta u&#39;}{\partial x}\right)+ \nu\left(\nabla u, \nabla \delta u&#39;\right)-\left(f, \delta u&#39;\right)\]</p><p class="math-container">\[G(u,v,w) = \left(u \frac{\partial v}{\partial x}, \delta v&#39;\right) + \left(v \frac{\partial v}{\partial y}, \delta v&#39;\right)+ \left(w \frac{\partial v}{\partial z}, \delta v&#39;\right) -\frac{1}{\rho}\left(p, \frac{\partial \delta v&#39;}{\partial y}\right) +\nu\left(\nabla v, \nabla\delta v&#39;\right)- \left( g, \delta v&#39;\right)\]</p><p class="math-container">\[H(u,v,w) = \left(u \frac{\partial w}{\partial x}, \delta w&#39;\right) + \left(v \frac{\partial w}{\partial y}, \delta w&#39;\right)+ \left(w \frac{\partial w}{\partial z}, \delta w&#39;\right) -\frac{1}{\rho}\left(p, \frac{\partial \delta w&#39;}{\partial z}\right) +\nu\left(\nabla w, \nabla\delta w&#39;\right)- \left( h, \delta w&#39;\right)\]</p><p class="math-container">\[I(u, v,w) = \left(\frac{\partial u}{\partial x}, \delta p&#39;\right) + \left(\frac{\partial v}{\partial y}, \delta p&#39; \right)+\left(\frac{\partial w}{\partial z}, \delta p&#39; \right)\]</p><p>we have the following equation for one iteration of the Newton&#39;s method</p><p class="math-container">\[\begin{bmatrix}\nabla_u F(u, v, w)  &amp; \nabla_v F(u, v, w) &amp; \nabla_w F(u, v, w) &amp; \nabla_p F(u, v, w)  \\ \nabla_u G(u, v, w)  &amp; \nabla_v G(u, v, w) &amp; \nabla_w G(u, v, w) &amp; \nabla_p G(u, v, w) \\ \nabla_u H(u, v, w) &amp; \nabla_v H(u, v, w) &amp; \nabla_w H(u, v, w)&amp; \nabla_p H(u, v, w)  \\ \nabla_u I(u, v, w) &amp; \nabla_v I(u, v, w) &amp; \nabla_w I(u, v, w)&amp; 0 \end{bmatrix} \begin{bmatrix}\Delta u\\ \Delta v \\ \Delta w \\ \Delta p\end{bmatrix} = - \begin{bmatrix}F(u, v, w) \\ G(u, v, w)\\H(u, v, w) \\I(u, v, w) \end{bmatrix} \tag{9}\]</p><p class="math-container">\[\begin{bmatrix} u_{new}\\ v_{new}\\ w_{new} \\ p_{new} \end{bmatrix} = \begin{bmatrix} u\\ v \\ w \\ p\end{bmatrix} + \begin{bmatrix}\Delta u\\ \Delta v  \\ \Delta w \\\Delta p \end{bmatrix}\]</p><p>We use Taylor&#39;s expansion to linearize <span>$F(u+\Delta u, v+\Delta v, w+\Delta w), G(u+\Delta u, v+\Delta v, w+\Delta w), H(u+\Delta u, v+\Delta v, w+\Delta w)$</span> and obtain</p><p class="math-container">\[F(u+\Delta u, v+\Delta v, w+\Delta w) = F(u, v, w) + \nabla_u F(u, v, w)\Delta u   + \nabla_v F(u, v, w) \Delta v+ \nabla_w F(u, v, w) \Delta w\]</p><p class="math-container">\[G(u+\Delta u, v+\Delta v, w+\Delta w) = G(u, v, w) + \nabla_u G(u, v, w)\Delta u   + \nabla_v G(u, v, w) \Delta v+ \nabla_w G(u, v, w) \Delta w\]</p><p class="math-container">\[H(u+\Delta u, v+\Delta v, w+\Delta w) = H(u, v, w) + \nabla_u H(u, v, w)\Delta u   + \nabla_v H(u, v, w) \Delta v+ \nabla_w H(u, v, w) \Delta w\]</p><p>Thus, we have</p><p class="math-container">\[\nabla_u F(u, v, w)\Delta u = \left(\Delta u \frac{\partial u}{\partial x}, \delta u&#39;\right) +\left(u \frac{\partial \Delta u }{\partial x}, \delta u&#39;\right)+ \left(v \frac{\partial \Delta u }{\partial y}, \delta u&#39;\right)+ \left(w \frac{\partial \Delta u }{\partial z}, \delta u&#39;\right) + (\nu\nabla (\Delta u), \nabla \delta u&#39;)\]</p><p class="math-container">\[\nabla_v F(u, v, w)\Delta v = \left(\Delta v \frac{\partial u}{\partial y}, \delta u&#39;\right)\]</p><p class="math-container">\[\nabla_w F(u, v, w)\Delta w = \left(\Delta w \frac{\partial u}{\partial z}, \delta u&#39;\right)\]</p><p class="math-container">\[\nabla_u G(u, v, w)\Delta u = \left(\Delta u \frac{\partial v}{\partial x}, \delta v&#39;\right)\]</p><p class="math-container">\[\nabla_v G(u, v, w)\Delta v = \left(\Delta v \frac{\partial v}{\partial y}, \delta v&#39;\right)+ \left(u \frac{\partial \Delta v }{\partial x}, \delta v&#39;\right) +\left(v \frac{\partial \Delta v }{\partial y}, \delta v&#39;\right) +\left(w \frac{\partial \Delta v }{\partial z}, \delta v&#39;\right) + (ν\nabla (\Delta v), \nabla \delta v&#39;)\]</p><p class="math-container">\[\nabla_w G(u, v, w)\Delta w = \left(\Delta w \frac{\partial v}{\partial z}, \delta v&#39;\right)\]</p><p class="math-container">\[\nabla_u H(u, v, w)\Delta u = \left(\Delta u \frac{\partial w}{\partial x}, \delta w&#39;\right)\]</p><p class="math-container">\[\nabla_v H(u, v, w)\Delta v = \left(\Delta v \frac{\partial w}{\partial y}, \delta w&#39;\right)\]</p><p class="math-container">\[\nabla_w H(u, v, w)\Delta w = \left(\Delta w \frac{\partial w}{\partial z}, \delta w&#39;\right)+ \left(u \frac{\partial \Delta w }{\partial x}, \delta w&#39;\right) +\left(v \frac{\partial \Delta w }{\partial y}, \delta w&#39;\right) +\left(w \frac{\partial \Delta w }{\partial z}, \delta w&#39;\right) + (ν\nabla (\Delta w), \nabla \delta w&#39;)\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../SteadyStateNavierStokes/">« Steady-state Navier-Stokes equations</a><a class="docs-footer-nextpage" href="../CHTCoupled/">Conjugate heat transfer coupled solver for incompressible fluid »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 6 March 2021 19:50">Saturday 6 March 2021</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
