<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Navier-Stokes equations for Incompressible Fluid · PoreFlow</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">PoreFlow</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">PoreFlow.jl Documentation</a></li><li><a class="tocitem" href="../gallery/">PDE Galleries</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../coupled/">Coupled Geomechanics and Single Phase Flow</a></li><li><a class="tocitem" href="../staticelasticity/">Static Linear Elasticity</a></li><li><a class="tocitem" href="../plasticity/">Plasticity</a></li><li><a class="tocitem" href="../viscoelasticity/">Viscoelasticity</a></li><li><a class="tocitem" href="../viscoelasticity_earth/">Modeling Viscoelasticity of the Earth</a></li><li><a class="tocitem" href="../earthquake/">Earthquake Simulation with Rate-and-State Friction</a></li><li><a class="tocitem" href="../heatequation/">Heat Equation</a></li><li><a class="tocitem" href="../elastodynamics/">Elastodynamics</a></li><li><a class="tocitem" href="../twophaseflow/">Coupled Geomechanics and Multiphase Flow</a></li><li class="is-active"><a class="tocitem" href>Navier-Stokes equations for Incompressible Fluid</a></li></ul></li><li><span class="tocitem">Inverse Modeling</span><ul><li><a class="tocitem" href="../inverse/">Inverse Modeling for Poroelasticity Models</a></li><li><a class="tocitem" href="../inv_viscoelasticity/">Inverse Modeling for Space Varying Viscoelasticity</a></li><li><a class="tocitem" href="../coupled_viscoelasticity/">Coupled Viscoelasticity and Single Phase Flow</a></li><li><a class="tocitem" href="../inv_twophaseflow/">Coupled Geomechanics and Multiphase Flow</a></li><li><a class="tocitem" href="../inv_viscoelasticity_nonparametric/">Inverse Modeling for Nonparametric Viscoelasticity</a></li><li><a class="tocitem" href="../inv_viscoelasticity_earth/">Viscoelasticity Model for the Earth</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Navier-Stokes equations for Incompressible Fluid</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Navier-Stokes equations for Incompressible Fluid</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kailaix/PoreFlow.jl/blob/master/docs/src/NavierStokes2.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Navier-Stokes-equations-for-Incompressible-Fluid"><a class="docs-heading-anchor" href="#Navier-Stokes-equations-for-Incompressible-Fluid">Navier-Stokes equations for Incompressible Fluid</a><a id="Navier-Stokes-equations-for-Incompressible-Fluid-1"></a><a class="docs-heading-anchor-permalink" href="#Navier-Stokes-equations-for-Incompressible-Fluid" title="Permalink"></a></h1><p>The incompressible Navier-Stokes equations in the absence of body force, and in two spatial dimensions, are given by</p><div>\[\frac{\partial u}{\partial x}+\frac{\partial v}{\partial y}=0 \\
\frac{\partial u}{\partial t}+u \frac{\partial u}{\partial x}+v \frac{\partial u}{\partial y}=-\frac{1}{\rho} \frac{\partial p}{\partial x}+\nu\left(\frac{\partial^{2} u}{\partial x^{2}}+\frac{\partial^{2} u}{\partial y^{2}}\right) \\
\frac{\partial v}{\partial t}+u \frac{\partial v}{\partial x}+v \frac{\partial v}{\partial y}=-\frac{1}{\rho} \frac{\partial p}{\partial y}+\nu\left(\frac{\partial^{2} v}{\partial x^{2}}+\frac{\partial^{2} v}{\partial y^{2}}\right)\]</div><p>The first of the above equation represents the continuity equation and the other two represent the momentum equations.</p><p>The implicit scheme</p><p>Step 1:</p><p>The first step is to solve a nonlinear equation</p><div>\[\frac{\partial (u+\Delta u) }{\partial t}+(u+\Delta u) \frac{\partial (u+\Delta u)}{\partial x}+(v+\Delta v) \frac{\partial (u+\Delta u)}{\partial y}=-\frac{1}{\rho} \frac{\partial p}{\partial x}+\nu\left(\frac{\partial^{2} (u+\Delta u)}{\partial x^{2}}+\frac{\partial^{2} (u+\Delta u)}{\partial y^{2}}\right) \\
\frac{\partial (v+\Delta v)}{\partial t}+(u+\Delta u) \frac{\partial (v+\Delta v)}{\partial x}+(v+\Delta v) \frac{\partial (v+\Delta v)}{\partial y}=-\frac{1}{\rho} \frac{\partial p}{\partial y}+\nu\left(\frac{\partial^{2} (v+\Delta v)}{\partial x^{2}}+\frac{\partial^{2} (v+\Delta v)}{\partial y^{2}}\right) \tag{1}\]</div><p>Here the inputs <span>$u, v$</span> are defined in the finite element space, and <span>$p$</span> in defined in the finite volume space. We solve for <span>$\Delta u, \Delta v$</span> using the finite element method by linearizing Equation 1. </p><p>Let <span>$\delta u&#39;$</span> denote the finite element basis for <span>$u$</span>, and <span>$\delta v&#39;$</span> denote the finite element basis for <span>$v$</span>. To derive the weak form of Equation 1, we multiply both sides of Equation 1 by <span>$\delta u&#39;$</span> and <span>$\delta v&#39;$</span>, respectively.</p><div>\[\int_\Omega \left( \frac{\partial (u+\Delta u) }{\partial t}+(u+\Delta u) \frac{\partial (u+\Delta u)}{\partial x}+(v+\Delta v) \frac{\partial (u+\Delta u)}{\partial y} , \delta u&#39;\right) d\Omega=\int_\Omega \left( -\frac{1}{\rho} \frac{\partial p}{\partial x}+\nu\left(\frac{\partial^{2} (u+\Delta u)}{\partial x^{2}}+\frac{\partial^{2} (u+\Delta u)}{\partial y^{2}}\right), \delta u&#39;\right) d\Omega\\
\int_\Omega \left( \frac{\partial (v+\Delta v)}{\partial t}+(u+\Delta u) \frac{\partial (v+\Delta v)}{\partial x}+(v+\Delta v) \frac{\partial (v+\Delta v)}{\partial y}, \delta v&#39;\right) d\Omega=\int_\Omega \left( -\frac{1}{\rho} \frac{\partial p}{\partial y}+\nu\left(\frac{\partial^{2} (v+\Delta v)}{\partial x^{2}}+\frac{\partial^{2} (v+\Delta v)}{\partial y^{2}}\right), \delta v&#39;\right) d\Omega\]</div><p>We use a backward Euler&#39;s method to discretize the equation in time, i.e., </p><div>\[\frac{\partial (u + \Delta u)}{\partial t} \approx \frac{\Delta u}{\Delta t}\]</div><p>Then we have the following formula </p><div>\[\int_\Omega \left( \frac{ \Delta u }{\Delta t}+(u+\Delta u) \frac{\partial (u+\Delta u)}{\partial x}+(v+\Delta v) \frac{\partial (u+\Delta u)}{\partial y} , \delta u&#39;\right)d\Omega =\int_\Omega \left( -\frac{1}{\rho} \frac{\partial p}{\partial x}+\nu\left(\frac{\partial^{2} (u+\Delta u)}{\partial x^{2}}+\frac{\partial^{2} (u+\Delta u)}{\partial y^{2}}\right), \delta u&#39;\right) d\Omega \\
\int_\Omega \left( \frac{\Delta v}{\Delta t}+(u+\Delta u) \frac{\partial (v+\Delta v)}{\partial x}+(v+\Delta v) \frac{\partial (v+\Delta v)}{\partial y}, \delta v&#39;\right) d\Omega=\int_\Omega \left( -\frac{1}{\rho} \frac{\partial p}{\partial y}+\nu\left(\frac{\partial^{2} (v+\Delta v)}{\partial x^{2}}+\frac{\partial^{2} (v+\Delta v)}{\partial y^{2}}\right), \delta v&#39;\right)d\Omega\]</div><p>By ignoring the nonlinear term in the weak form, we finally have the following bilinear and linear forms in the weak formulation </p><div>\[\begin{bmatrix}A_{11} &amp; A_{12} \\ A_{21} &amp; A_{22}\end{bmatrix} \qquad \begin{bmatrix}F_1\\ F_2\end{bmatrix}\]</div><p>Here</p><div>\[A_{11} = \frac{1}{\Delta t}\left( \Delta u, \delta u&#39; \right) + \left(  \frac{\partial u}{\partial x}\Delta u, \delta u&#39; \right) + \left( u \frac{\partial \Delta u}{\partial x}, \delta u&#39; \right) + \left( v \frac{\partial \Delta u}{\partial y}, \delta u&#39; \right) + \nu \left( \nabla (\Delta u), \nabla (\delta u&#39;) \right)\]</div><div>\[A_{12} = \left(\frac{\partial u}{\partial y} \Delta v, \delta u&#39; \right)\]</div><div>\[A_{21} = \left(\frac{\partial v}{\partial x} \Delta u, \delta v&#39; \right)\]</div><div>\[A_{22} = \frac{1}{\Delta t}\left( \Delta v, \delta v&#39; \right) + \left(  \frac{\partial v}{\partial y}\Delta v, \delta v&#39; \right) + \left(  v\frac{\partial \Delta v}{\partial y}, \delta v&#39; \right) + \left( u \frac{\partial \Delta v}{\partial x}, \delta v&#39; \right) + \nu \left( \nabla (\Delta v), \nabla (\delta v&#39;) \right)\]</div><div>\[F_1 = \frac{1}{\rho} \left( p, \frac{\partial \delta u&#39;}{\partial x}\right) - \nu (\nabla u, \nabla \delta u&#39;) - \left( u\frac{\partial u}{\partial x}, \delta u&#39; \right) -  \left( v\frac{\partial u}{\partial y}, \delta u&#39; \right)\]</div><div>\[F_2 = \frac{1}{\rho}  \left( p, \frac{\partial \delta v&#39;}{\partial y}\right)- \nu (\nabla v, \nabla \delta v&#39;) - \left( v\frac{\partial v}{\partial y}, \delta v&#39; \right) -  \left( u\frac{\partial v}{\partial x}, \delta v&#39; \right)\]</div><p>Step 2:</p><p>Solve the following Poisson equation for <span>$\Delta p$</span></p><div>\[\frac{\Delta t}{\rho} \left( \frac{\partial^2 \Delta p}{\partial x^2 } +  \frac{\partial^2 \Delta p}{\partial y^2 } \right) =\frac{\partial u^{*}}{\partial x} + \frac{\partial u^{*}}{\partial y}\]</div><p>where the input is obtained by <span>$u^{*} = u + \Delta u, v^{*} = v + \Delta v$</span> and defined in the finite element method, and we solve for the pressure correction term <span>$\Delta p$</span> defined in the finite volume method.</p><p>Then, we can compute the pressure for the next discrete time point</p><div>\[p_{new} = p+ \Delta p\]</div><p>Step 3:</p><p>We solve for the velocity field for the next discrete time point using the finite element method</p><div>\[u_{new} = u^{*} - \frac{\Delta t}{\rho} \frac{\partial \Delta p }{\partial x}\]</div><div>\[v_{new} = v^{*} - \frac{\Delta t}{\rho}  \frac{\partial \Delta  p}{\partial y}\]</div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../twophaseflow/">« Coupled Geomechanics and Multiphase Flow</a><a class="docs-footer-nextpage" href="../inverse/">Inverse Modeling for Poroelasticity Models »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 11 July 2020 04:38">Saturday 11 July 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
